<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vahram Poghosyan">
<meta name="dcterms.date" content="2024-12-20">

<title>Build a CI/CD Pipeline using Github Actions and Terraform – v-poghosyan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KLCX05QFPN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KLCX05QFPN', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">v-poghosyan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Info</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Build a CI/CD Pipeline using Github Actions and Terraform</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Software Engineering</div>
                <div class="quarto-category">Infrastructure</div>
                <div class="quarto-category">Hosting</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vahram Poghosyan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 20, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#answer-1" id="toc-answer-1" class="nav-link" data-scroll-target="#answer-1">Answer 1</a>
  <ul class="collapse">
  <li><a href="#use-terraform-for-infrastructure-deployment" id="toc-use-terraform-for-infrastructure-deployment" class="nav-link" data-scroll-target="#use-terraform-for-infrastructure-deployment"><strong>1. Use Terraform for Infrastructure Deployment</strong></a></li>
  <li><a href="#set-up-a-version-control-system-vcs" id="toc-set-up-a-version-control-system-vcs" class="nav-link" data-scroll-target="#set-up-a-version-control-system-vcs"><strong>2. Set Up a Version Control System (VCS)</strong></a></li>
  <li><a href="#choose-a-cicd-tool" id="toc-choose-a-cicd-tool" class="nav-link" data-scroll-target="#choose-a-cicd-tool"><strong>3. Choose a CI/CD Tool</strong></a></li>
  <li><a href="#configure-aws-credentials" id="toc-configure-aws-credentials" class="nav-link" data-scroll-target="#configure-aws-credentials"><strong>4. Configure AWS Credentials</strong></a></li>
  <li><a href="#set-up-remote-state-management" id="toc-set-up-remote-state-management" class="nav-link" data-scroll-target="#set-up-remote-state-management"><strong>5. Set Up Remote State Management</strong></a></li>
  <li><a href="#build-the-pipeline" id="toc-build-the-pipeline" class="nav-link" data-scroll-target="#build-the-pipeline"><strong>6. Build the Pipeline</strong></a></li>
  <li><a href="#additional-tools" id="toc-additional-tools" class="nav-link" data-scroll-target="#additional-tools"><strong>7. Additional Tools</strong></a></li>
  <li><a href="#optional-if-you-meant-ansible-instead-of-angular" id="toc-optional-if-you-meant-ansible-instead-of-angular" class="nav-link" data-scroll-target="#optional-if-you-meant-ansible-instead-of-angular"><strong>8. Optional: If You Meant Ansible Instead of Angular</strong></a></li>
  <li><a href="#important-notes" id="toc-important-notes" class="nav-link" data-scroll-target="#important-notes"><strong>Important Notes</strong></a></li>
  </ul></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#answer-2" id="toc-answer-2" class="nav-link" data-scroll-target="#answer-2">Answer 2</a>
  <ul class="collapse">
  <li><a href="#storing-aws-credentials-as-repository-secrets" id="toc-storing-aws-credentials-as-repository-secrets" class="nav-link" data-scroll-target="#storing-aws-credentials-as-repository-secrets"><strong>1. Storing AWS Credentials as Repository Secrets</strong></a></li>
  <li><a href="#setting-up-remote-state-with-s3-and-dynamodb" id="toc-setting-up-remote-state-with-s3-and-dynamodb" class="nav-link" data-scroll-target="#setting-up-remote-state-with-s3-and-dynamodb"><strong>2. Setting Up Remote State with S3 and DynamoDB</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="question-1" class="level1">
<h1>Question 1</h1>
<p>How can I write a pipeline that deploys AWS infrastructure using either Terraform or Ansible? Do I need other tools? If so, which?</p>
</section>
<section id="answer-1" class="level1">
<h1>Answer 1</h1>
<p>To create a pipeline that deploys AWS infrastructure using Terraform, you’ll need to set up a Continuous Integration and Continuous Deployment (CI/CD) process. Here’s how you can do it and the tools you’ll need.</p>
<hr>
<section id="use-terraform-for-infrastructure-deployment" class="level3">
<h3 class="anchored" data-anchor-id="use-terraform-for-infrastructure-deployment"><strong>1. Use Terraform for Infrastructure Deployment</strong></h3>
<p><strong>Terraform</strong> is an open-source Infrastructure as Code (IaC) tool that allows you to define and provision infrastructure using code. It is well-suited for deploying AWS resources.</p>
</section>
<section id="set-up-a-version-control-system-vcs" class="level3">
<h3 class="anchored" data-anchor-id="set-up-a-version-control-system-vcs"><strong>2. Set Up a Version Control System (VCS)</strong></h3>
<p>Use a VCS like <strong>Git</strong> to manage your Terraform code. Host your repositories on platforms such as:</p>
<ul>
<li><strong>GitHub</strong></li>
<li><strong>GitLab</strong></li>
<li><strong>Bitbucket</strong></li>
</ul>
</section>
<section id="choose-a-cicd-tool" class="level3">
<h3 class="anchored" data-anchor-id="choose-a-cicd-tool"><strong>3. Choose a CI/CD Tool</strong></h3>
<p>Select a CI/CD tool to automate your deployment pipeline. Popular options include:</p>
<ul>
<li><strong>Jenkins</strong></li>
<li><strong>GitHub Actions</strong></li>
<li><strong>GitLab CI/CD</strong></li>
<li><strong>CircleCI</strong></li>
<li><strong>AWS CodePipeline</strong></li>
</ul>
<p>For seamless AWS integration, <strong>AWS CodePipeline</strong> is a good choice.</p>
</section>
<section id="configure-aws-credentials" class="level3">
<h3 class="anchored" data-anchor-id="configure-aws-credentials"><strong>4. Configure AWS Credentials</strong></h3>
<p>Securely manage AWS credentials required for deployment:</p>
<ul>
<li>Use <strong>AWS Identity and Access Management (IAM)</strong> roles and users.</li>
<li>Store credentials securely using environment variables or the CI/CD tool’s secret management features.</li>
<li><strong>Never</strong> hardcode credentials in your code.</li>
</ul>
</section>
<section id="set-up-remote-state-management" class="level3">
<h3 class="anchored" data-anchor-id="set-up-remote-state-management"><strong>5. Set Up Remote State Management</strong></h3>
<p>Terraform uses state files to keep track of resource mappings. Store the state remotely:</p>
<ul>
<li>Use an <strong>S3 bucket</strong> with <strong>DynamoDB</strong> for state locking.</li>
<li>Alternatively, use <strong>Terraform Cloud</strong> or <strong>Terraform Enterprise</strong>.</li>
</ul>
</section>
<section id="build-the-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="build-the-pipeline"><strong>6. Build the Pipeline</strong></h3>
<section id="a.-write-terraform-configuration" class="level4">
<h4 class="anchored" data-anchor-id="a.-write-terraform-configuration"><strong>a. Write Terraform Configuration</strong></h4>
<p>Define your AWS infrastructure in <code>.tf</code> files:</p>
<pre class="hcl"><code># provider.tf
provider "aws" {
  region = "us-east-1"
}

# main.tf
resource "aws_s3_bucket" "my_bucket" {
  bucket = "my-example-bucket"
  acl    = "private"
}</code></pre>
</section>
<section id="b.-initialize-git-repository" class="level4">
<h4 class="anchored" data-anchor-id="b.-initialize-git-repository"><strong>b. Initialize Git Repository</strong></h4>
<p>Initialize a Git repository and commit your Terraform code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> init</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add .</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Initial commit"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push origin main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="c.-configure-the-cicd-pipeline" class="level4">
<h4 class="anchored" data-anchor-id="c.-configure-the-cicd-pipeline"><strong>c.&nbsp;Configure the CI/CD Pipeline</strong></h4>
<section id="option-1-using-github-actions" class="level5">
<h5 class="anchored" data-anchor-id="option-1-using-github-actions"><strong>Option 1: Using GitHub Actions</strong></h5>
<p>Create a workflow file <code>.github/workflows/deploy.yml</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Deploy</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">terraform</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Checkout Code</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v3</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Setup Terraform</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> hashicorp/setup-terraform@v2</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Init</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">run</span><span class="kw">:</span><span class="at"> terraform init</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Terraform Apply</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">run</span><span class="kw">:</span><span class="at"> terraform apply -auto-approve</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">AWS_ACCESS_KEY_ID</span><span class="kw">:</span><span class="at"> ${{ secrets.AWS_ACCESS_KEY_ID }}</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">AWS_SECRET_ACCESS_KEY</span><span class="kw">:</span><span class="at"> ${{ secrets.AWS_SECRET_ACCESS_KEY }}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Store AWS Credentials</strong>: Add <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> to your repository’s secrets.</li>
</ul>
</section>
<section id="option-2-using-aws-codepipeline" class="level5">
<h5 class="anchored" data-anchor-id="option-2-using-aws-codepipeline"><strong>Option 2: Using AWS CodePipeline</strong></h5>
<ul>
<li><strong>Create a Pipeline</strong>: Set up AWS CodePipeline with stages for source, build, and deploy.</li>
<li><strong>Use CodeBuild</strong>: Configure AWS CodeBuild to run Terraform commands.</li>
</ul>
</section>
</section>
<section id="d.-securely-manage-state" class="level4">
<h4 class="anchored" data-anchor-id="d.-securely-manage-state"><strong>d.&nbsp;Securely Manage State</strong></h4>
<p>Configure Terraform to use remote state:</p>
<pre class="hcl"><code># backend.tf
terraform {
  backend "s3" {
    bucket         = "my-terraform-state-bucket"
    key            = "state/terraform.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-state-lock"
    encrypt        = true
  }
}</code></pre>
</section>
<section id="e.-test-the-pipeline" class="level4">
<h4 class="anchored" data-anchor-id="e.-test-the-pipeline"><strong>e. Test the Pipeline</strong></h4>
<ul>
<li><strong>Commit and Push</strong>: Your CI/CD tool will trigger the pipeline on new commits.</li>
<li><strong>Review Outputs</strong>: Monitor the pipeline for successful deployment.</li>
</ul>
</section>
</section>
<section id="additional-tools" class="level3">
<h3 class="anchored" data-anchor-id="additional-tools"><strong>7. Additional Tools</strong></h3>
<ul>
<li><strong>Terraform Modules</strong>: Reusable modules for organizing code.</li>
<li><strong>Terragrunt</strong>: Enhances Terraform with wrappers for state and configuration.</li>
<li><strong>Linting and Formatting</strong>:
<ul>
<li>Use <code>terraform fmt</code> for formatting.</li>
<li>Use <code>tflint</code> for linting your code.</li>
</ul></li>
<li><strong>Security Scanning</strong>:
<ul>
<li>Integrate tools like <strong>Checkov</strong> or <strong>TFSec</strong> to scan for security issues.</li>
</ul></li>
</ul>
</section>
<section id="optional-if-you-meant-ansible-instead-of-angular" class="level3">
<h3 class="anchored" data-anchor-id="optional-if-you-meant-ansible-instead-of-angular"><strong>8. Optional: If You Meant Ansible Instead of Angular</strong></h3>
<p><strong>Ansible</strong> is another automation tool that can manage infrastructure:</p>
<ul>
<li>Use Ansible playbooks to define AWS resources.</li>
<li>Requires AWS modules and credentials setup.</li>
<li>Can be integrated into a CI/CD pipeline similarly.</li>
</ul>
</section>
<section id="important-notes" class="level3">
<h3 class="anchored" data-anchor-id="important-notes"><strong>Important Notes</strong></h3>
<ul>
<li><strong>Angular</strong> is a web application framework and not used for infrastructure deployment. If you intended to refer to another tool (like Ansible), consider using that instead.</li>
<li><strong>Testing</strong>: Always test your infrastructure changes in a non-production environment first.</li>
<li><strong>Monitoring</strong>: Implement monitoring and logging for your infrastructure using AWS CloudWatch or similar services.</li>
</ul>
<hr>
<p><strong>Summary</strong></p>
<p>To deploy AWS infrastructure using Terraform:</p>
<ol type="1">
<li><strong>Write</strong> your infrastructure code with Terraform.</li>
<li><strong>Use</strong> a VCS to manage code changes.</li>
<li><strong>Set up</strong> a CI/CD pipeline with a tool like GitHub Actions or AWS CodePipeline.</li>
<li><strong>Securely manage</strong> AWS credentials and Terraform state.</li>
<li><strong>Automate</strong> the deployment process through the pipeline.</li>
<li><strong>Monitor</strong> and <strong>maintain</strong> your infrastructure post-deployment.</li>
</ol>
<p>By integrating these tools and practices, you’ll have an automated pipeline that helps you efficiently manage and deploy your AWS infrastructure.</p>
</section>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<p>“Store AWS Credentials: Add <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> to your repository’s secrets.”</p>
<p>Expand on this step. Also expand on “using an S3 bucket with DynamoDB for state locking.”</p>
</section>
<section id="answer-2" class="level1">
<h1>Answer 2</h1>
<p><strong>Expanding on Storing AWS Credentials in Repository Secrets</strong></p>
<p>When setting up your CI/CD pipeline to deploy AWS infrastructure using Terraform, it’s crucial to securely manage your AWS credentials. These credentials are necessary for Terraform to authenticate with AWS and provision resources on your behalf. Exposing these credentials in your code or configuration files poses significant security risks. Instead, store them securely using your repository’s secret management features.</p>
<hr>
<section id="storing-aws-credentials-as-repository-secrets" class="level3">
<h3 class="anchored" data-anchor-id="storing-aws-credentials-as-repository-secrets"><strong>1. Storing AWS Credentials as Repository Secrets</strong></h3>
<section id="a.-generate-aws-access-keys" class="level4">
<h4 class="anchored" data-anchor-id="a.-generate-aws-access-keys"><strong>a. Generate AWS Access Keys</strong></h4>
<p>Before storing credentials, you need AWS access keys with appropriate permissions:</p>
<ul>
<li><strong>Create an IAM User:</strong>
<ol type="1">
<li>Navigate to the <a href="https://console.aws.amazon.com/iam/">AWS IAM Console</a>.</li>
<li>Click <strong>Users</strong> → <strong>Add users</strong>.</li>
<li>Enter a user name (e.g., <code>terraform-ci-user</code>).</li>
<li>Select <strong>Programmatic access</strong> for <strong>Access type</strong>.</li>
<li>Click <strong>Next: Permissions</strong>.</li>
<li>Assign permissions:
<ul>
<li><strong>Best Practice:</strong> Attach policies granting least privilege necessary (e.g., custom policy or predefined policies like <code>AmazonS3FullAccess</code> and specific permissions for other services).</li>
</ul></li>
<li>Complete the steps to create the user.</li>
</ol></li>
<li><strong>Download Credentials:</strong>
<ul>
<li>After creation, download the <strong>Access Key ID</strong> and <strong>Secret Access Key</strong>.</li>
<li><strong>Important:</strong> Store these securely; you cannot retrieve the secret key again after this point.</li>
</ul></li>
</ul>
</section>
<section id="b.-store-credentials-in-repository-secrets" class="level4">
<h4 class="anchored" data-anchor-id="b.-store-credentials-in-repository-secrets"><strong>b. Store Credentials in Repository Secrets</strong></h4>
<section id="github-actions" class="level5">
<h5 class="anchored" data-anchor-id="github-actions"><strong>GitHub Actions</strong></h5>
<ul>
<li><strong>Navigate to Repository Settings:</strong>
<ul>
<li>Go to your GitHub repository.</li>
<li>Click on the <strong>Settings</strong> tab.</li>
<li>In the left sidebar, select <strong>Secrets and variables</strong> → <strong>Actions</strong>.</li>
</ul></li>
<li><strong>Add New Secrets:</strong>
<ul>
<li>Click <strong>New repository secret</strong>.</li>
<li>Add the <strong>Access Key ID</strong>:
<ul>
<li><strong>Name:</strong> <code>AWS_ACCESS_KEY_ID</code></li>
<li><strong>Value:</strong> <em>Your AWS Access Key ID</em></li>
</ul></li>
<li>Add another secret for the <strong>Secret Access Key</strong>:
<ul>
<li><strong>Name:</strong> <code>AWS_SECRET_ACCESS_KEY</code></li>
<li><strong>Value:</strong> <em>Your AWS Secret Access Key</em></li>
</ul></li>
</ul></li>
<li><strong>Reference Secrets in Workflow:</strong>
<ul>
<li><p>In your <code>.github/workflows/deploy.yml</code>, reference the secrets:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">AWS_ACCESS_KEY_ID</span><span class="kw">:</span><span class="at"> ${{ secrets.AWS_ACCESS_KEY_ID }}</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">AWS_SECRET_ACCESS_KEY</span><span class="kw">:</span><span class="at"> ${{ secrets.AWS_SECRET_ACCESS_KEY }}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul>
</section>
<section id="gitlab-cicd" class="level5">
<h5 class="anchored" data-anchor-id="gitlab-cicd"><strong>GitLab CI/CD</strong></h5>
<ul>
<li><p><strong>Navigate to Project Settings:</strong></p>
<ul>
<li>Go to your GitLab project.</li>
<li>Click <strong>Settings</strong> → <strong>CI/CD</strong>.</li>
<li>Expand the <strong>Variables</strong> section.</li>
</ul></li>
<li><p><strong>Add Variables:</strong></p>
<ul>
<li>Click <strong>Add Variable</strong>.
<ul>
<li><strong>Key:</strong> <code>AWS_ACCESS_KEY_ID</code></li>
<li><strong>Value:</strong> <em>Your AWS Access Key ID</em></li>
<li><strong>Flags:</strong> Masked, Protected</li>
</ul></li>
<li>Add another variable:
<ul>
<li><strong>Key:</strong> <code>AWS_SECRET_ACCESS_KEY</code></li>
<li><strong>Value:</strong> <em>Your AWS Secret Access Key</em></li>
<li><strong>Flags:</strong> Masked, Protected</li>
</ul></li>
</ul></li>
<li><p><strong>Reference Variables in <code>.gitlab-ci.yml</code>:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">AWS_ACCESS_KEY_ID</span><span class="kw">:</span><span class="at"> $AWS_ACCESS_KEY_ID</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">AWS_SECRET_ACCESS_KEY</span><span class="kw">:</span><span class="at"> $AWS_SECRET_ACCESS_KEY</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
</section>
<section id="c.-security-best-practices" class="level4">
<h4 class="anchored" data-anchor-id="c.-security-best-practices"><strong>c.&nbsp;Security Best Practices</strong></h4>
<ul>
<li><strong>Never Hardcode Credentials:</strong>
<ul>
<li>Do not include credentials in your code or commit them to version control.</li>
</ul></li>
<li><strong>Use Least Privilege:</strong>
<ul>
<li>Grant only the necessary permissions to the IAM user.</li>
</ul></li>
<li><strong>Rotate Credentials Regularly:</strong>
<ul>
<li>Periodically update your access keys for better security.</li>
</ul></li>
<li><strong>Audit and Monitor Access:</strong>
<ul>
<li>Use AWS CloudTrail and other monitoring tools to keep track of usage.</li>
</ul></li>
</ul>
<hr>
<p><strong>Expanding on Using an S3 Bucket with DynamoDB for State Locking</strong></p>
<p>Terraform uses state files to keep track of the resources it manages. Storing the state remotely allows team collaboration and provides a central source of truth. Using an S3 bucket with DynamoDB for state locking ensures that only one operation can modify the state at a time, preventing conflicts.</p>
<hr>
</section>
</section>
<section id="setting-up-remote-state-with-s3-and-dynamodb" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-remote-state-with-s3-and-dynamodb"><strong>2. Setting Up Remote State with S3 and DynamoDB</strong></h3>
<section id="a.-create-an-s3-bucket-for-remote-state" class="level4">
<h4 class="anchored" data-anchor-id="a.-create-an-s3-bucket-for-remote-state"><strong>a. Create an S3 Bucket for Remote State</strong></h4>
<ol type="1">
<li><strong>Navigate to S3 Console:</strong>
<ul>
<li>Go to the <a href="https://s3.console.aws.amazon.com/s3/">AWS S3 Console</a>.</li>
</ul></li>
<li><strong>Create a New Bucket:</strong>
<ul>
<li>Click <strong>Create bucket</strong>.</li>
<li><strong>Bucket Name:</strong> Must be globally unique (e.g., <code>my-terraform-state-bucket-1234</code>).</li>
<li><strong>Region:</strong> Choose the AWS region closest to your resources.</li>
</ul></li>
<li><strong>Configure Bucket Options:</strong>
<ul>
<li><strong>Versioning:</strong> Enable versioning to keep track of changes to the state file.</li>
<li><strong>Encryption:</strong> Enable server-side encryption (SSE-S3 or SSE-KMS) for security.</li>
<li><strong>Block Public Access:</strong> Ensure all public access is blocked.</li>
</ul></li>
<li><strong>Review and Create:</strong>
<ul>
<li>Review settings and create the bucket.</li>
</ul></li>
</ol>
</section>
<section id="b.-create-a-dynamodb-table-for-state-locking" class="level4">
<h4 class="anchored" data-anchor-id="b.-create-a-dynamodb-table-for-state-locking"><strong>b. Create a DynamoDB Table for State Locking</strong></h4>
<ol type="1">
<li><strong>Navigate to DynamoDB Console:</strong>
<ul>
<li>Go to the <a href="https://console.aws.amazon.com/dynamodb/">AWS DynamoDB Console</a>.</li>
</ul></li>
<li><strong>Create a New Table:</strong>
<ul>
<li>Click <strong>Create table</strong>.</li>
<li><strong>Table Name:</strong> e.g., <code>terraform-lock-table</code>.</li>
<li><strong>Partition Key:</strong> <code>LockID</code> (String).</li>
<li><strong>Settings:</strong> Use default settings unless you have specific requirements.</li>
</ul></li>
<li><strong>Create the Table:</strong>
<ul>
<li>Complete the creation process.</li>
</ul></li>
</ol>
</section>
<section id="c.-configure-terraform-backend" class="level4">
<h4 class="anchored" data-anchor-id="c.-configure-terraform-backend"><strong>c.&nbsp;Configure Terraform Backend</strong></h4>
<p>In your Terraform configuration, specify the backend as follows:</p>
<pre class="hcl"><code># backend.tf

terraform {
  backend "s3" {
    bucket         = "my-terraform-state-bucket-1234"
    key            = "global/s3/terraform.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-lock-table"
    encrypt        = true
  }
}</code></pre>
<ul>
<li><strong>bucket:</strong> The name of your S3 bucket.</li>
<li><strong>key:</strong> The path within the bucket for the state file.</li>
<li><strong>region:</strong> AWS region for S3 and DynamoDB.</li>
<li><strong>dynamodb_table:</strong> Your DynamoDB table name.</li>
<li><strong>encrypt:</strong> Enables server-side encryption.</li>
</ul>
</section>
<section id="d.-initialize-terraform-with-backend" class="level4">
<h4 class="anchored" data-anchor-id="d.-initialize-terraform-with-backend"><strong>d.&nbsp;Initialize Terraform with Backend</strong></h4>
<ul>
<li><p>Run <code>terraform init</code> to initialize the backend configuration.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">terraform</span> init</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Terraform will detect the backend settings and use the S3 bucket for state storage.</p></li>
</ul>
</section>
<section id="e.-iam-permissions" class="level4">
<h4 class="anchored" data-anchor-id="e.-iam-permissions"><strong>e. IAM Permissions</strong></h4>
<p>Ensure the IAM user or role used by Terraform has the necessary permissions:</p>
<ul>
<li><p><strong>S3 Permissions:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3:PutObject"</span><span class="ot">,</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3:GetObject"</span><span class="ot">,</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3:DeleteObject"</span><span class="ot">,</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3:ListBucket"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Resource"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arn:aws:s3:::my-terraform-state-bucket-1234"</span><span class="ot">,</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arn:aws:s3:::my-terraform-state-bucket-1234/*"</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>DynamoDB Permissions:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Effect"</span><span class="fu">:</span> <span class="st">"Allow"</span><span class="fu">,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Action"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:PutItem"</span><span class="ot">,</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:GetItem"</span><span class="ot">,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:DeleteItem"</span><span class="ot">,</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:UpdateItem"</span><span class="ot">,</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:Scan"</span><span class="ot">,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dynamodb:Query"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Resource"</span><span class="fu">:</span> <span class="st">"arn:aws:dynamodb:us-east-1:123456789012:table/terraform-lock-table"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
<p>Replace <code>my-terraform-state-bucket-1234</code> with your bucket name and ensure the AWS account ID and region are correct.</p>
</section>
<section id="f.-benefits-of-using-s3-and-dynamodb" class="level4">
<h4 class="anchored" data-anchor-id="f.-benefits-of-using-s3-and-dynamodb"><strong>f.&nbsp;Benefits of Using S3 and DynamoDB</strong></h4>
<ul>
<li><strong>Remote State Storage:</strong>
<ul>
<li>Centralized state file accessible by your CI/CD pipeline and team members.</li>
</ul></li>
<li><strong>State Locking with DynamoDB:</strong>
<ul>
<li>Prevents simultaneous operations that could corrupt the state.</li>
</ul></li>
<li><strong>Versioning and Encryption:</strong>
<ul>
<li>State file history is preserved, and data is secured.</li>
</ul></li>
</ul>
</section>
<section id="g.-security-best-practices" class="level4">
<h4 class="anchored" data-anchor-id="g.-security-best-practices"><strong>g. Security Best Practices</strong></h4>
<ul>
<li><strong>Restrict Access to State Files:</strong>
<ul>
<li>Limit S3 bucket access to only necessary users and roles.</li>
</ul></li>
<li><strong>Encrypt Sensitive Data:</strong>
<ul>
<li>Use <code>encrypt = true</code> in the backend configuration.</li>
</ul></li>
<li><strong>Monitor State Access:</strong>
<ul>
<li>Use AWS CloudTrail to audit access to S3 and DynamoDB.</li>
</ul></li>
</ul>
<hr>
<p><strong>Summary</strong></p>
<p>By securely storing your AWS credentials in repository secrets and configuring Terraform to use an S3 bucket with DynamoDB for remote state and locking, you enhance the security and reliability of your infrastructure deployment pipeline.</p>
<ul>
<li><strong>AWS Credentials:</strong>
<ul>
<li>Use your CI/CD platform’s secret management to store credentials securely.</li>
<li>Reference these secrets in your pipeline configuration.</li>
<li>Apply security best practices for credential management.</li>
</ul></li>
<li><strong>Terraform Remote State:</strong>
<ul>
<li>Store the state file in an S3 bucket with versioning and encryption.</li>
<li>Use a DynamoDB table for state locking to prevent concurrent modifications.</li>
<li>Ensure IAM policies grant only the necessary permissions.</li>
</ul></li>
</ul>
<p>Feel free to ask if you need further details on any of these steps or assistance with configuring your pipeline.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/v-poghosyan\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2021, Vahram Poghosyan</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/v-poghosyan">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vahrampoghosyan/">
      <i class="bi bi-linkedin" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script type="application/javascript" src="../../javascript/light-dark.js"></script>




</body></html>